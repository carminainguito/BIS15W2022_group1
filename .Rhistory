summarise(mean_happiness_score = mean(happiness_score),
mean_gdp_contrib = mean(economy_gdp_per_capita),
mean_family_contrib = mean(family),
mean_health_contrib = mean(health_life_expectancy),
mean_freedom_contrib = mean(freedom),
mean_trust_contrib = mean(trust_government_corruption),
mean_generosity_contrib = mean(generosity))
summary(complete_happiness)
glimpse(complete_happiness)
complete_happiness %>%
naniar::miss_var_summary()
happiness_venn <- complete_happiness_ave %>%
mutate(economy_contribution_percentage = mean_gdp_contrib/mean_happiness_score,
family_contribution_percentage = mean_family_contrib/mean_happiness_score,
health_contribution_percentage = mean_health_contrib/mean_happiness_score,
freedom_contribution_percentage = mean_freedom_contrib/mean_happiness_score,
generosity_contribution_percentage = mean_generosity_contrib/mean_happiness_score,
trust_contribution_percentage = mean_trust_contrib/mean_happiness_score,
happiness_category = case_when(mean_happiness_score <= 3 ~ "very unhappy",
mean_happiness_score > 3 & mean_happiness_score <= 5 ~ "unhappy",
mean_happiness_score > 5 & mean_happiness_score <= 7 ~ "happy",
mean_happiness_score > 7 ~ "very happy"),
economy_category = case_when(economy_contribution_percentage < 0.0833 ~ "insignificant",
economy_contribution_percentage >= 0.0833 ~ "significant"),
family_category = case_when(family_contribution_percentage < 0.0833 ~ "insignificant",
family_contribution_percentage >= 0.0833 ~ "significant"),
health_category = case_when(health_contribution_percentage < 0.0833 ~ "insignificant",
health_contribution_percentage >= 0.0833 ~ "significant"),
freedom_category = case_when(freedom_contribution_percentage < 0.0833 ~ "insignificant",
freedom_contribution_percentage >= 0.0833 ~ "significant"),
generosity_category = case_when(generosity_contribution_percentage < 0.0833 ~ "insignificant",
generosity_contribution_percentage >= 0.0833 ~ "significant"),
trust_category = case_when(trust_contribution_percentage < 0.0833 ~ "insignificant",
trust_contribution_percentage >= 0.0833 ~ "significant"))
happy_country_vec <- happiness_venn %>%
filter(happiness_category == "happy" | happiness_category == "very happy")%>%
pull(country_or_region)
gdp_vec <- happiness_venn %>%
filter(economy_category == "significant")%>%
pull(country_or_region)
generosity_vec <- happiness_venn %>%
filter(generosity_category == "significant")%>%
pull(country_or_region)
family_vec <- happiness_venn %>%
filter(family_category == "significant")%>%
pull(country_or_region)
health_vec <- happiness_venn %>%
filter(health_category == "significant")%>%
pull(country_or_region)
freedom_vec <- happiness_venn %>%
filter(freedom_category == "significant")%>%
pull(country_or_region)
trust_vec <- happiness_venn %>%
filter(trust_category == "significant")%>%
pull(country_or_region)
why_happy_list <- list(happy_country_vec, gdp_vec, generosity_vec)
ggVennDiagram(why_happy_list,
category.names = c("Happy Country", "GDP", "Generosity"),
label_color = "black")+
ggplot2::scale_fill_gradient(low="navyblue",high = "yellow")
happiness_pie <- complete_happiness_ave %>%
group_by(country_or_region)%>%
summarise(economy_contribution_percentage = mean_gdp_contrib/mean_happiness_score,
family_contribution_percentage = mean_family_contrib/mean_happiness_score,
health_contribution_percentage = mean_health_contrib/mean_happiness_score,
freedom_contribution_percentage = mean_freedom_contrib/mean_happiness_score,
generosity_contribution_percentage = mean_generosity_contrib/mean_happiness_score,
trust_contribution_percentage = mean_trust_contrib/mean_happiness_score)%>%
pivot_longer(-country_or_region,
names_to = "factor",
values_to = "score_perc")
complete_happiness_ave%>%
arrange(desc(mean_happiness_score))%>%
head(n=5)%>%
pull(country_or_region)
cats <- happiness_pie$factor
cats <- str_replace(cats, c('economy_contribution_percentage'), replacement = 'GDP')
cats <- str_replace(cats, c('family_contribution_percentage'), replacement = 'Family')
cats <- str_replace(cats, c('health_contribution_percentage'), replacement = 'Life Expectancy')
cats <- str_replace(cats, c('freedom_contribution_percentag'), replacement = 'Freedom')
cats <- str_replace(cats, c('generosity_contribution_percentage'), replacement = 'Generosity')
cats <- str_replace(cats, c('trust_contribution_percentage'), replacement = 'Government Trust')
happiness_pie2 <- happiness_pie %>%
mutate(labels = round(score_perc*100, digits = 2))
happiness_pie2$factor = cats
happy_pie <- happiness_pie2 %>%
filter(country_or_region == "Denmark")%>%
select(country_or_region, labels, factor)
happy_pie2 <- happy_pie %>%
mutate(pie_prop = labels/sum(happy_pie$labels)*100) %>%
mutate(y_pos = cumsum(pie_prop)-0.5*pie_prop)
ggplot(happy_pie2, aes(x="", y = pie_prop, fill = factor))+
geom_bar(stat="identity", width=1, color="white") +
coord_polar("y", start = 0) +
theme_minimal() +
theme(legend.position= "right") +
guides(fill = guide_legend(title = "Factors"))+
geom_text(aes(y = pie_prop, label = percent(labels/100)), color = "black", size=3, angle = 2, position = position_stack(vjust = 0.5)) +
scale_fill_brewer(palette="Set2")+
facet_wrap(~country_or_region)
ggplot(happy_pie2, aes(x="", y = pie_prop, fill = factor))+
geom_bar(stat="identity", width=1, color="white") +
coord_polar("y", start = 0) +
theme_minimal() +
theme(legend.position= "right") +
guides(fill = guide_legend(title = "Factors"))+
geom_text(aes(y = pie_prop, label = percent(labels/100)), color = "black", size=3, angle = 2, position = position_stack(vjust = 0.5)) +
scale_fill_brewer(palette="Set2")+
facet_wrap(~country_or_region)
ggplot(happy_pie2, aes(x="", y = pie_prop, fill = factor))+
geom_bar(stat="identity", width=1, color="white") +
coord_polar("y", start = 0) +
theme_void() +
theme(legend.position= "right") +
guides(fill = guide_legend(title = "Factors"))+
geom_text(aes(y = pie_prop, label = percent(labels/100)), color = "black", size=3, angle = 2, position = position_stack(vjust = 0.5)) +
scale_fill_brewer(palette="Set2")+
facet_wrap(~country_or_region)
ggplot(happy_pie2, aes(x="", y = pie_prop, fill = factor))+
geom_bar(stat="identity", width=1, color="white") +
coord_polar("y", start = 0) +
theme_solid() +
theme(legend.position= "right") +
guides(fill = guide_legend(title = "Factors"))+
geom_text(aes(y = pie_prop, label = percent(labels/100)), color = "black", size=3, angle = 2, position = position_stack(vjust = 0.5)) +
scale_fill_brewer(palette="Set2")+
facet_wrap(~country_or_region)
ggplot(happy_pie2, aes(x="", y = pie_prop, fill = factor))+
geom_bar(stat="identity", width=1, color="white") +
coord_polar("y", start = 0) +
theme_clean() +
theme(legend.position= "right") +
guides(fill = guide_legend(title = "Factors"))+
geom_text(aes(y = pie_prop, label = percent(labels/100)), color = "black", size=3, angle = 2, position = position_stack(vjust = 0.5)) +
scale_fill_brewer(palette="Set2")+
facet_wrap(~country_or_region)
ggplot(happy_pie2, aes(x="", y = pie_prop, fill = factor))+
geom_bar(stat="identity", width=1, color="white") +
coord_polar("y", start = 0) +
theme_minimal() +
theme(legend.position= "right") +
guides(fill = guide_legend(title = "Factors"))+
geom_text(aes(y = pie_prop, label = percent(labels/100)), color = "black", size=3, angle = 2, position = position_stack(vjust = 0.5)) +
scale_fill_brewer(palette="Set2")+
facet_wrap(~country_or_region)
ggplot(happy_pie2, aes(x="", y = pie_prop, fill = factor))+
geom_bar(stat="identity", width=1, color="white") +
coord_polar("y", start = 0) +
theme_minimal() +
theme(legend.position= "right") +
guides(fill = guide_legend(title = "Factors"))+
geom_text(aes(y = pie_prop, label = percent(labels/100)), color = "black", size=3, angle = 2, position = position_stack(vjust = 0.5)) +
xlab("") + ylab("Proportions")
scale_fill_brewer(palette="Set2")+
facet_wrap(~country_or_region)
ggplot(happy_pie2, aes(x="", y = pie_prop, fill = factor))+
geom_bar(stat="identity", width=1, color="white") +
coord_polar("y", start = 0) +
theme_minimal() +
theme(legend.position= "right") +
guides(fill = guide_legend(title = "Factors"))+
geom_text(aes(y = pie_prop, label = percent(labels/100)), color = "black", size=3, angle = 2, position = position_stack(vjust = 0.5)) +
xlab("") + ylab("Proportions")+
scale_fill_brewer(palette="Set2")+
facet_wrap(~country_or_region)
ggplot(happy_pie2, aes(x="", y = pie_prop, fill = factor))+
geom_bar(stat="identity", width=1, color="white") +
coord_polar("y", start = 0) +
theme_minimal() +
theme(legend.position= "right") +
guides(fill = guide_legend(title = "Factors"))+
geom_text(aes(y = pie_prop, label = percent(labels/100)), color = "black", size=3, angle = 2, position = position_stack(vjust = 0.5)) +
labs(title = "Denmark", x = "", y= "Proportions")+
scale_fill_brewer(palette="Set2")+
facet_wrap(~country_or_region)
ggplot(happy_pie2, aes(x="", y = pie_prop, fill = factor))+
geom_bar(stat="identity", width=1, color="white") +
coord_polar("y", start = 0) +
theme_minimal() +
theme(legend.position= "right") +
guides(fill = guide_legend(title = "Factors"))+
geom_text(aes(y = pie_prop, label = percent(labels/100)), color = "black", size=3, angle = 2, position = position_stack(vjust = 0.5)) +
labs(x = "", y= "Proportions")+
scale_fill_brewer(palette="Set2")+
facet_wrap(~country_or_region)
happiness_pie2 <- happiness_pie %>%
mutate(labels = round(score_perc*100, digits = 2))
happiness_pie2$factor = cats
happy_pie <- happiness_pie2 %>%
filter(country_or_region == "Norway")%>%
select(country_or_region, labels, factor)
happy_pie2 <- happy_pie %>%
mutate(pie_prop = labels/sum(happy_pie$labels)*100) %>%
mutate(y_pos = cumsum(pie_prop)-0.5*pie_prop)
happiness_pie2 <- happiness_pie %>%
mutate(labels = round(score_perc*100, digits = 2))
happiness_pie2$factor = cats
happy_pie <- happiness_pie2 %>%
filter(country_or_region == "Denmark")%>%
select(country_or_region, labels, factor)
happy_pie2 <- happy_pie %>%
mutate(pie_prop = labels/sum(happy_pie$labels)*100) %>%
mutate(y_pos = cumsum(pie_prop)-0.5*pie_prop)
ggplot(happy_pie2, aes(x="", y = pie_prop, fill = factor))+
geom_bar(stat="identity", width=1, color="white") +
coord_polar("y", start = 0) +
theme_minimal() +
theme(legend.position= "right") +
guides(fill = guide_legend(title = "Factors"))+
geom_text(aes(y = pie_prop, label = percent(labels/100)), color = "black", size=3, angle = 2, position = position_stack(vjust = 0.5)) +
labs(x = "", y= "Proportions")+
scale_fill_brewer(palette="Set2")+
facet_wrap(~country_or_region)
View(happy_pie2)
p1 <- ggplot(happy_pie2, aes(x="", y = pie_prop, fill = factor))+
geom_bar(stat="identity", width=1, color="white") +
coord_polar("y", start = 0) +
theme_minimal() +
theme(legend.position= "right") +
guides(fill = guide_legend(title = "Factors"))+
geom_text(aes(y = pie_prop, label = percent(labels/100)), color = "black", size=3, angle = 2, position = position_stack(vjust = 0.5)) +
labs(x = "", y= "Proportions")+
scale_fill_brewer(palette="Set2")+
facet_wrap(~country_or_region)
p1
happiness_pie2 <- happiness_pie %>%
mutate(labels = round(score_perc*100, digits = 2))
happiness_pie2$factor = cats
happy_pie1 <- happiness_pie2 %>%
filter(country_or_region == "Denmark")%>%
select(country_or_region, labels, factor)
happy_pie1_2 <- happy_pie %>%
mutate(pie_prop = labels/sum(happy_pie$labels)*100) %>%
mutate(y_pos = cumsum(pie_prop)-0.5*pie_prop)
p1 <- ggplot(happy_pie1_2, aes(x="", y = pie_prop, fill = factor))+
geom_bar(stat="identity", width=1, color="white") +
coord_polar("y", start = 0) +
theme_minimal() +
theme(legend.position= "right") +
guides(fill = guide_legend(title = "Factors"))+
geom_text(aes(y = pie_prop, label = percent(labels/100)), color = "black", size=3, angle = 2, position = position_stack(vjust = 0.5)) +
labs(x = "", y= "Proportions")+
scale_fill_brewer(palette="Set2")+
facet_wrap(~country_or_region)
View(p1)
p1 <- ggplot(happy_pie1_2, aes(x="", y = pie_prop, fill = factor))+
geom_bar(stat="identity", width=1, color="white") +
coord_polar("y", start = 0) +
theme_minimal() +
theme(legend.position= "right") +
guides(fill = guide_legend(title = "Factors"))+
geom_text(aes(y = pie_prop, label = percent(labels/100)), color = "black", size=3, angle = 2, position = position_stack(vjust = 0.5)) +
labs(x = "", y= "Proportions")+
scale_fill_brewer(palette="Set2")+
facet_wrap(~country_or_region)
p1
p1 <- ggplot(happy_pie1_2, aes(x="", y = pie_prop, fill = factor))+
geom_bar(stat="identity", width=1, color="white") +
coord_polar("y", start = 0) +
theme_minimal() +
theme(legend.position= "right") +
guides(fill = guide_legend(title = "Factors"))+
geom_text(aes(y = pie_prop, label = percent(labels/100)), color = "black", size=3, angle = 2, position = position_stack(vjust = 0.5)) +
labs(x = "", y= "Proportions")+
scale_fill_brewer(palette="Set2")+
facet_wrap(~country_or_region)
happy_pie2 <- happiness_pie2 %>%
filter(country_or_region == "Denmark")%>%
select(country_or_region, labels, factor)
happy_pie2_2 <- happy_pie %>%
mutate(pie_prop = labels/sum(happy_pie$labels)*100) %>%
mutate(y_pos = cumsum(pie_prop)-0.5*pie_prop)
happy_pie2 <- happiness_pie2 %>%
filter(country_or_region == "Norway")%>%
select(country_or_region, labels, factor)
happy_pie2_2 <- happy_pie %>%
mutate(pie_prop = labels/sum(happy_pie$labels)*100) %>%
mutate(y_pos = cumsum(pie_prop)-0.5*pie_prop)
p1 <- ggplot(happy_pie2_2, aes(x="", y = pie_prop, fill = factor))+
geom_bar(stat="identity", width=1, color="white") +
coord_polar("y", start = 0) +
theme_minimal() +
theme(legend.position= "right") +
guides(fill = guide_legend(title = "Factors"))+
geom_text(aes(y = pie_prop, label = percent(labels/100)), color = "black", size=3, angle = 2, position = position_stack(vjust = 0.5)) +
labs(x = "", y= "Proportions")+
scale_fill_brewer(palette="Set2")+
facet_wrap(~country_or_region)
p2 <- ggplot(happy_pie2_2, aes(x="", y = pie_prop, fill = factor))+
geom_bar(stat="identity", width=1, color="white") +
coord_polar("y", start = 0) +
theme_minimal() +
theme(legend.position= "right") +
guides(fill = guide_legend(title = "Factors"))+
geom_text(aes(y = pie_prop, label = percent(labels/100)), color = "black", size=3, angle = 2, position = position_stack(vjust = 0.5)) +
labs(x = "", y= "Proportions")+
scale_fill_brewer(palette="Set2")+
facet_wrap(~country_or_region)
p1 <- ggplot(happy_pie1_2, aes(x="", y = pie_prop, fill = factor))+
geom_bar(stat="identity", width=1, color="white") +
coord_polar("y", start = 0) +
theme_minimal() +
theme(legend.position= "right") +
guides(fill = guide_legend(title = "Factors"))+
geom_text(aes(y = pie_prop, label = percent(labels/100)), color = "black", size=3, angle = 2, position = position_stack(vjust = 0.5)) +
labs(x = "", y= "Proportions")+
scale_fill_brewer(palette="Set2")+
facet_wrap(~country_or_region)
happy_pie3 <- happiness_pie2 %>%
filter(country_or_region == "Denmark")%>%
select(country_or_region, labels, factor)
happy_pie3_2 <- happy_pie %>%
mutate(pie_prop = labels/sum(happy_pie$labels)*100) %>%
mutate(y_pos = cumsum(pie_prop)-0.5*pie_prop)
happy_pie3 <- happiness_pie2 %>%
filter(country_or_region == "Finland")%>%
select(country_or_region, labels, factor)
happy_pie3_2 <- happy_pie %>%
mutate(pie_prop = labels/sum(happy_pie$labels)*100) %>%
mutate(y_pos = cumsum(pie_prop)-0.5*pie_prop)
p3 <- ggplot(happy_pie3_2, aes(x="", y = pie_prop, fill = factor))+
geom_bar(stat="identity", width=1, color="white") +
coord_polar("y", start = 0) +
theme_minimal() +
theme(legend.position= "right") +
guides(fill = guide_legend(title = "Factors"))+
geom_text(aes(y = pie_prop, label = percent(labels/100)), color = "black", size=3, angle = 2, position = position_stack(vjust = 0.5)) +
labs(x = "", y= "Proportions")+
scale_fill_brewer(palette="Set2")+
facet_wrap(~country_or_region)
happy_pie4 <- happiness_pie2 %>%
filter(country_or_region == "Switzerland")%>%
select(country_or_region, labels, factor)
happy_pie4_2 <- happy_pie %>%
mutate(pie_prop = labels/sum(happy_pie$labels)*100) %>%
mutate(y_pos = cumsum(pie_prop)-0.5*pie_prop)
p4 <- ggplot(happy_pie4_2, aes(x="", y = pie_prop, fill = factor))+
geom_bar(stat="identity", width=1, color="white") +
coord_polar("y", start = 0) +
theme_minimal() +
theme(legend.position= "right") +
guides(fill = guide_legend(title = "Factors"))+
geom_text(aes(y = pie_prop, label = percent(labels/100)), color = "black", size=3, angle = 2, position = position_stack(vjust = 0.5)) +
labs(x = "", y= "Proportions")+
scale_fill_brewer(palette="Set2")+
facet_wrap(~country_or_region)
happy_pie5 <- happiness_pie2 %>%
filter(country_or_region == "Iceland")%>%
select(country_or_region, labels, factor)
happy_pie5_2 <- happy_pie %>%
mutate(pie_prop = labels/sum(happy_pie$labels)*100) %>%
mutate(y_pos = cumsum(pie_prop)-0.5*pie_prop)
p5 <- ggplot(happy_pie5_2, aes(x="", y = pie_prop, fill = factor))+
geom_bar(stat="identity", width=1, color="white") +
coord_polar("y", start = 0) +
theme_minimal() +
theme(legend.position= "right") +
guides(fill = guide_legend(title = "Factors"))+
geom_text(aes(y = pie_prop, label = percent(labels/100)), color = "black", size=3, angle = 2, position = position_stack(vjust = 0.5)) +
labs(x = "", y= "Proportions")+
scale_fill_brewer(palette="Set2")+
facet_wrap(~country_or_region)
p1, p2, p3, p4, p5
p1
p2
p3
p4
p5
happiness_pie2 <- happiness_pie %>%
mutate(labels = round(score_perc*100, digits = 2))
happiness_pie2$factor = cats
happy_pie1 <- happiness_pie2 %>%
filter(country_or_region == "Denmark")%>%
select(country_or_region, labels, factor)
happy_pie1_2 <- happy_pie %>%
mutate(pie_prop = labels/sum(happy_pie$labels)*100) %>%
mutate(y_pos = cumsum(pie_prop)-0.5*pie_prop)
p1 <- ggplot(happy_pie1_2, aes(x="", y = pie_prop, fill = factor))+
geom_bar(stat="identity", width=1, color="white") +
coord_polar("y", start = 0) +
theme_minimal() +
theme(legend.position= "right") +
guides(fill = guide_legend(title = "Factors"))+
geom_text(aes(y = pie_prop, label = percent(labels/100)), color = "black", size=3, angle = 2, position = position_stack(vjust = 0.5)) +
labs(x = "", y= "Proportions")+
scale_fill_brewer(palette="Set2")+
facet_wrap(~country_or_region)
happiness_pie2 <- happiness_pie %>%
mutate(labels = round(score_perc*100, digits = 2))
happiness_pie2$factor = cats
happy_pie1 <- happiness_pie2 %>%
filter(country_or_region == "Denmark")%>%
select(country_or_region, labels, factor)
happy_pie1_2 <- happy_pie %>%
mutate(pie_prop = labels/sum(happy_pie$labels)*100) %>%
mutate(y_pos = cumsum(pie_prop)-0.5*pie_prop)
happiness_pie2 <- happiness_pie %>%
mutate(labels = round(score_perc*100, digits = 2))
happiness_pie2$factor = cats
happy_pie1 <- happiness_pie2 %>%
filter(country_or_region == "Denmark")%>%
select(country_or_region, labels, factor)
happy_pie1_2 <- happy_pie %>%
mutate(pie_prop = labels/sum(happy_pie$labels)*100) %>%
mutate(y_pos = cumsum(pie_prop)-0.5*pie_prop)
View(happy_pie1)
View(happy_pie1_2)
View(happy_pie2)
happy_pie2 <- happiness_pie2 %>%
filter(country_or_region == "Norway")%>%
select(country_or_region, labels, factor)
happy_pie2_2 <- happy_pie %>%
mutate(pie_prop = labels/sum(happy_pie$labels)*100) %>%
mutate(y_pos = cumsum(pie_prop)-0.5*pie_prop)
p2 <- ggplot(happy_pie2_2, aes(x="", y = pie_prop, fill = factor))+
geom_bar(stat="identity", width=1, color="white") +
coord_polar("y", start = 0) +
theme_minimal() +
theme(legend.position= "right") +
guides(fill = guide_legend(title = "Factors"))+
geom_text(aes(y = pie_prop, label = percent(labels/100)), color = "black", size=3, angle = 2, position = position_stack(vjust = 0.5)) +
labs(x = "", y= "Proportions")+
scale_fill_brewer(palette="Set2")+
facet_wrap(~country_or_region)
happiness_pie2 <- happiness_pie %>%
mutate(labels = round(score_perc*100, digits = 2))
happiness_pie2$factor = cats
happy_pie1 <- happiness_pie2 %>%
filter(country_or_region == "Denmark")%>%
select(country_or_region, labels, factor)
happy_pie1_2 <- happy_pie1 %>%
mutate(pie_prop = labels/sum(happy_pie$labels)*100) %>%
mutate(y_pos = cumsum(pie_prop)-0.5*pie_prop)
p1 <- ggplot(happy_pie1_2, aes(x="", y = pie_prop, fill = factor))+
geom_bar(stat="identity", width=1, color="white") +
coord_polar("y", start = 0) +
theme_minimal() +
theme(legend.position= "right") +
guides(fill = guide_legend(title = "Factors"))+
geom_text(aes(y = pie_prop, label = percent(labels/100)), color = "black", size=3, angle = 2, position = position_stack(vjust = 0.5)) +
labs(x = "", y= "Proportions")+
scale_fill_brewer(palette="Set2")+
facet_wrap(~country_or_region)
happy_pie2 <- happiness_pie2 %>%
filter(country_or_region == "Norway")%>%
select(country_or_region, labels, factor)
happy_pie2_2 <- happy_pie2 %>%
mutate(pie_prop = labels/sum(happy_pie$labels)*100) %>%
mutate(y_pos = cumsum(pie_prop)-0.5*pie_prop)
p2 <- ggplot(happy_pie2_2, aes(x="", y = pie_prop, fill = factor))+
geom_bar(stat="identity", width=1, color="white") +
coord_polar("y", start = 0) +
theme_minimal() +
theme(legend.position= "right") +
guides(fill = guide_legend(title = "Factors"))+
geom_text(aes(y = pie_prop, label = percent(labels/100)), color = "black", size=3, angle = 2, position = position_stack(vjust = 0.5)) +
labs(x = "", y= "Proportions")+
scale_fill_brewer(palette="Set2")+
facet_wrap(~country_or_region)
happy_pie3 <- happiness_pie2 %>%
filter(country_or_region == "Finland")%>%
select(country_or_region, labels, factor)
happy_pie3_2 <- happy_pie3 %>%
mutate(pie_prop = labels/sum(happy_pie$labels)*100) %>%
mutate(y_pos = cumsum(pie_prop)-0.5*pie_prop)
p3 <- ggplot(happy_pie3_2, aes(x="", y = pie_prop, fill = factor))+
geom_bar(stat="identity", width=1, color="white") +
coord_polar("y", start = 0) +
theme_minimal() +
theme(legend.position= "right") +
guides(fill = guide_legend(title = "Factors"))+
geom_text(aes(y = pie_prop, label = percent(labels/100)), color = "black", size=3, angle = 2, position = position_stack(vjust = 0.5)) +
labs(x = "", y= "Proportions")+
scale_fill_brewer(palette="Set2")+
facet_wrap(~country_or_region)
happy_pie4 <- happiness_pie2 %>%
filter(country_or_region == "Switzerland")%>%
select(country_or_region, labels, factor)
happy_pie4_2 <- happy_pie4 %>%
mutate(pie_prop = labels/sum(happy_pie$labels)*100) %>%
mutate(y_pos = cumsum(pie_prop)-0.5*pie_prop)
p4 <- ggplot(happy_pie4_2, aes(x="", y = pie_prop, fill = factor))+
geom_bar(stat="identity", width=1, color="white") +
coord_polar("y", start = 0) +
theme_minimal() +
theme(legend.position= "right") +
guides(fill = guide_legend(title = "Factors"))+
geom_text(aes(y = pie_prop, label = percent(labels/100)), color = "black", size=3, angle = 2, position = position_stack(vjust = 0.5)) +
labs(x = "", y= "Proportions")+
scale_fill_brewer(palette="Set2")+
facet_wrap(~country_or_region)
happy_pie5 <- happiness_pie2 %>%
filter(country_or_region == "Iceland")%>%
select(country_or_region, labels, factor)
happy_pie5_2 <- happy_pie5 %>%
mutate(pie_prop = labels/sum(happy_pie$labels)*100) %>%
mutate(y_pos = cumsum(pie_prop)-0.5*pie_prop)
p5 <- ggplot(happy_pie5_2, aes(x="", y = pie_prop, fill = factor))+
geom_bar(stat="identity", width=1, color="white") +
coord_polar("y", start = 0) +
theme_minimal() +
theme(legend.position= "right") +
guides(fill = guide_legend(title = "Factors"))+
geom_text(aes(y = pie_prop, label = percent(labels/100)), color = "black", size=3, angle = 2, position = position_stack(vjust = 0.5)) +
labs(x = "", y= "Proportions")+
scale_fill_brewer(palette="Set2")+
facet_wrap(~country_or_region)
p1
p2
p3
p4
p5
