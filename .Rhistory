happiness2 <- happiness
renamed <- happiness2$NAME
renamed <- str_replace(renamed, c('United Arab Emirates'), replacement = 'Libyan Arab Jamahiriya')
renamed <- str_replace(renamed, c('Venezuela Bolivarian Republic of'), replacement = 'Venezuela')
renamed <- str_replace(renamed, c('South Sudan'), replacement = 'Sudan')
renamed <- str_replace(renamed, c('Congo_(Brazzaville)'), replacement = 'Congo')
renamed <- str_replace(renamed, c('Congo_(Kinshasa)'), replacement = 'Democratic Republic of the Congo')
renamed <- str_replace(renamed, c('Iran'), replacement = 'Iran (Islamic Republic of)')
happiness2$NAME = renamed
happiness <- happiness_2019_join %>%
select(country_or_region, happiness_score, economy_gdp_per_capita, family, health_life_expectancy, freedom, generosity, trust_government_corruption)%>%
rename(NAME="country_or_region")
happiness
View(happiness)
happiness2 <- happiness
renamed <- happiness2$NAME
renamed <- str_replace(renamed, c('Lybia'), replacement = 'Libyan Arab Jamahiriya')
renamed <- str_replace(renamed, c('Venezuela Bolivarian Republic of'), replacement = 'Venezuela')
renamed <- str_replace(renamed, c('South Sudan'), replacement = 'Sudan')
renamed <- str_replace(renamed, c('Congo (Brazzaville)'), replacement = 'Congo')
renamed <- str_replace(renamed, c('Congo (Kinshasa)'), replacement = 'Democratic Republic of the Congo')
renamed <- str_replace(renamed, c('Tanzania'), replacement = 'United Republic of Tanzania')
renamed <- str_replace(renamed, c('Syria'), replacement = 'Syrian Arab Republic')
renamed <- str_replace(renamed, c('Iran'), replacement = 'Iran (Islamic Republic of)')
happiness2$NAME = renamed
world_map@data <- left_join(world_map@data, happiness2, by="NAME")
world_map@data$happiness_score[ which(world_map@data$happiness_score == 0)] = NA
getwd()
world_map <- readOGR(
dsn= paste0("data/TM_WORLD_BORDERS_SIMPL-0.3.shp"),
layer="TM_WORLD_BORDERS_SIMPL-0.3",
verbose=FALSE
)
happiness <- happiness_2019_join %>%
select(country_or_region, happiness_score, economy_gdp_per_capita, family, health_life_expectancy, freedom, generosity, trust_government_corruption)%>%
rename(NAME="country_or_region")
happiness
happiness2 <- happiness
renamed <- happiness2$NAME
renamed <- str_replace(renamed, c('Lybia'), replacement = 'Libyan Arab Jamahiriya')
renamed <- str_replace(renamed, c('Venezuela Bolivarian Republic of'), replacement = 'Venezuela')
renamed <- str_replace(renamed, c('South Sudan'), replacement = 'Sudan')
renamed <- str_replace(renamed, c('Congo (Brazzaville)'), replacement = 'Congo')
renamed <- str_replace(renamed, c('Congo (Kinshasa)'), replacement = 'Democratic Republic of the Congo')
renamed <- str_replace(renamed, c('Tanzania'), replacement = 'United Republic of Tanzania')
renamed <- str_replace(renamed, c('Syria'), replacement = 'Syrian Arab Republic')
renamed <- str_replace(renamed, c('Iran'), replacement = 'Iran (Islamic Republic of)')
happiness2$NAME = renamed
world_map@data <- left_join(world_map@data, happiness2, by="NAME")
world_map@data$happiness_score[ which(world_map@data$happiness_score == 0)] = NA
world_map@data$happiness_score <- as.numeric(as.character(world_map@data$happiness_score))%>% round(2)
mypalette <- colorNumeric( palette="viridis", domain=world_map@data$happiness_score, na.color="transparent")
mypalette(c(45,43))
m <- leaflet(world_map)%>% addTiles()  %>% setView( lat=10, lng=0 , zoom=2) %>%
addPolygons( stroke = FALSE, fillOpacity = 0.5, smoothFactor = 0.5, color = ~colorNumeric("Set3", happiness_score)(happiness_score) )
mybins <- c(0,2,4,6,8,10)
mypalette <- colorBin( palette="YlOrBr", domain=world_map@data$happiness_score, na.color="transparent", bins=mybins)
mytext <- paste(
"Country: ", world_map@data$NAME,"<br/>",
"GDP Contribution: ", world_map@data$economy_gdp_per_capita, "<br/>",
"Family Contribution: ", world_map@data$family, "<br/>",
"Life Expectancy Contribution: ", world_map@data$health_life_expectancy, "<br/>",
"Freedom Contribution: ", world_map@data$freedom, "<br/>",
"Generosity Contribution: ", world_map@data$generosity, "<br/>",
"Government Trust Contribution: ", world_map@data$trust_government_corruption, "<br/>",
"Happiness Score: ", round(world_map@data$happiness_score, 2),
sep="") %>%
lapply(htmltools::HTML)
happiness2 <- happiness
renamed <- happiness2$NAME
renamed <- str_replace(renamed, c('Libya'), replacement = 'Libyan Arab Jamahiriya')
renamed <- str_replace(renamed, c('Venezuela Bolivarian Republic of'), replacement = 'Venezuela')
renamed <- str_replace(renamed, c('South Sudan'), replacement = 'Sudan')
renamed <- str_replace(renamed, c('Congo (Brazzaville)'), replacement = 'Congo')
renamed <- str_replace(renamed, c('Congo (Kinshasa)'), replacement = 'Democratic Republic of the Congo')
renamed <- str_replace(renamed, c('Tanzania'), replacement = 'United Republic of Tanzania')
renamed <- str_replace(renamed, c('Syria'), replacement = 'Syrian Arab Republic')
renamed <- str_replace(renamed, c('Iran'), replacement = 'Iran (Islamic Republic of)')
happiness2$NAME = renamed
happiness2 <- happiness
renamed <- happiness2$NAME
renamed <- str_replace(renamed, c('Libya'), replacement = 'Libyan Arab Jamahiriya')
renamed <- str_replace(renamed, c('Venezuela Bolivarian Republic of'), replacement = 'Venezuela')
renamed <- str_replace(renamed, c('South Sudan'), replacement = 'Sudan')
renamed <- str_replace(renamed, c('Congo (Brazzaville)'), replacement = 'Congo')
renamed <- str_replace(renamed, c('Congo (Kinshasa)'), replacement = 'Democratic Republic of the Congo')
renamed <- str_replace(renamed, c('Tanzania'), replacement = 'United Republic of Tanzania')
renamed <- str_replace(renamed, c('Syria'), replacement = 'Syrian Arab Republic')
renamed <- str_replace(renamed, c('Iran'), replacement = 'Iran (Islamic Republic of)')
happiness2$NAME = renamed
happiness2 <- happiness
renamed <- happiness2$NAME
renamed <- str_replace(renamed, c('Libya'), replacement = 'Libyan Arab Jamahiriya')
renamed <- str_replace(renamed, c('Venezuela Bolivarian Republic of'), replacement = 'Venezuela')
renamed <- str_replace(renamed, c('South Sudan'), replacement = 'Sudan')
renamed <- str_replace(renamed, c('Congo (Brazzaville)'), replacement = 'Congo')
renamed <- str_replace(renamed, c('Congo (Kinshasa)'), replacement = 'Democratic Republic of the Congo')
renamed <- str_replace(renamed, c('Tanzania'), replacement = 'United Republic of Tanzania')
renamed <- str_replace(renamed, c('Syria'), replacement = 'Syrian Arab Republic')
renamed <- str_replace(renamed, c('Iran'), replacement = 'Iran (Islamic Republic of)')
happiness2$NAME = renamed
happiness <- happiness_2019_join %>%
select(country_or_region, happiness_score, economy_gdp_per_capita, family, health_life_expectancy, freedom, generosity, trust_government_corruption)%>%
rename(NAME="country_or_region")
happiness
happiness2 <- happiness
renamed <- happiness2$NAME
renamed <- str_replace(renamed, c('Libya'), replacement = 'Libyan Arab Jamahiriya')
renamed <- str_replace(renamed, c('Venezuela Bolivarian Republic of'), replacement = 'Venezuela')
renamed <- str_replace(renamed, c('South Sudan'), replacement = 'Sudan')
renamed <- str_replace(renamed, c('Congo (Brazzaville)'), replacement = 'Congo')
renamed <- str_replace(renamed, c('Congo (Kinshasa)'), replacement = 'Democratic Republic of the Congo')
renamed <- str_replace(renamed, c('Tanzania'), replacement = 'United Republic of Tanzania')
renamed <- str_replace(renamed, c('Syria'), replacement = 'Syrian Arab Republic')
renamed <- str_replace(renamed, c('Iran'), replacement = 'Iran (Islamic Republic of)')
renamed <- str_replace(renamed, c('Moldova'), replacement = 'Republic of Moldavo')
happiness2$NAME = renamed
leaflet(world_map) %>%
addTiles()  %>%
setView( lat=10, lng=0 , zoom=2) %>%
addPolygons(
fillColor = ~mypalette(happiness_score),
stroke=TRUE,
fillOpacity = 0.9,
color="white",
weight=0.3,
label = mytext,
labelOptions = labelOptions(
style = list("font-weight" = "normal", padding = "3px 8px"),
textsize = "13px",
direction = "auto"
)
) %>%
addLegend( pal=mypalette, values=~population, opacity=0.9, title = "Happiness Score", position = "bottomleft" )
m
happiness2 <- happiness
renamed <- happiness2$NAME
renamed <- str_replace(renamed, c('Libya'), replacement = 'Libyan Arab Jamahiriya')
renamed <- str_replace(renamed, c('Venezuela Bolivarian Republic of'), replacement = 'Venezuela')
renamed <- str_replace(renamed, c('South Sudan'), replacement = 'Sudan')
renamed <- str_replace(renamed, c('Congo+(Brazzaville)'), replacement = 'Congo')
renamed <- str_replace(renamed, c('Congo+(Kinshasa)'), replacement = 'Democratic Republic of the Congo')
renamed <- str_replace(renamed, c('Tanzania'), replacement = 'United Republic of Tanzania')
renamed <- str_replace(renamed, c('Syria'), replacement = 'Syrian Arab Republic')
renamed <- str_replace(renamed, c('Iran'), replacement = 'Iran (Islamic Republic of)')
renamed <- str_replace(renamed, c('Moldova'), replacement = 'Republic of Moldavo')
renamed <- str_replace(renamed, c('North Moldavo'), replacement = 'Republic of Moldavo')
renamed <- str_replace(renamed, c('Laos'), replacement = 'Lao People')
happiness2$NAME = renamed
happiness2 <- happiness
renamed <- happiness2$NAME
renamed <- str_replace(renamed, c('Libya'), replacement = 'Libyan Arab Jamahiriya')
renamed <- str_replace(renamed, c('Venezuela Bolivarian Republic of'), replacement = 'Venezuela')
renamed <- str_replace(renamed, c('South Sudan'), replacement = 'Sudan')
renamed <- str_replace(renamed, c('Congo Brazzaville'), replacement = 'Congo')
renamed <- str_replace(renamed, c('Congo Kinshasa'), replacement = 'Democratic Republic of the Congo')
renamed <- str_replace(renamed, c('Tanzania'), replacement = 'United Republic of Tanzania')
renamed <- str_replace(renamed, c('Syria'), replacement = 'Syrian Arab Republic')
renamed <- str_replace(renamed, c('Iran'), replacement = 'Iran (Islamic Republic of)')
renamed <- str_replace(renamed, c('Moldova'), replacement = 'Republic of Moldavo')
renamed <- str_replace(renamed, c('North Moldavo'), replacement = 'Republic of Moldavo')
renamed <- str_replace(renamed, c('Laos'), replacement = 'Lao People')
happiness2$NAME = renamed
happiness2 <- happiness
renamed <- happiness2$NAME
renamed <- str_replace(renamed, c('Libya'), replacement = 'Libyan Arab Jamahiriya')
renamed <- str_replace(renamed, c('Venezuela Bolivarian Republic of'), replacement = 'Venezuela')
renamed <- str_replace(renamed, c('South Sudan'), replacement = 'Sudan')
renamed <- str_replace(renamed, c('Congo Brazzaville'), replacement = 'Congo')
renamed <- str_replace(renamed, c("Congo (Kinshasa)"), replacement = 'Democratic Republic of the Congo')
renamed <- str_replace(renamed, c('Tanzania'), replacement = 'United Republic of Tanzania')
renamed <- str_replace(renamed, c('Syria'), replacement = 'Syrian Arab Republic')
renamed <- str_replace(renamed, c('Iran'), replacement = 'Iran (Islamic Republic of)')
renamed <- str_replace(renamed, c('Moldova'), replacement = 'Republic of Moldavo')
renamed <- str_replace(renamed, c('North Moldavo'), replacement = 'Republic of Moldavo')
renamed <- str_replace(renamed, c('Laos'), replacement = 'Lao People')
happiness2$NAME = renamed
happiness2 <- happiness
renamed <- happiness2$NAME
renamed <- str_replace(renamed, c('Libya'), replacement = 'Libyan Arab Jamahiriya')
renamed <- str_replace(renamed, c('Venezuela Bolivarian Republic of'), replacement = 'Venezuela')
renamed <- str_replace(renamed, c('South Sudan'), replacement = 'Sudan')
renamed <- str_replace(renamed, c('Congo Brazzaville'), replacement = 'Congo')
renamed <- str_replace(renamed, c('"Congo (Kinshasa)"'), replacement = 'Democratic Republic of the Congo')
renamed <- str_replace(renamed, c('Tanzania'), replacement = 'United Republic of Tanzania')
renamed <- str_replace(renamed, c('Syria'), replacement = 'Syrian Arab Republic')
renamed <- str_replace(renamed, c('Iran'), replacement = 'Iran (Islamic Republic of)')
renamed <- str_replace(renamed, c('Moldova'), replacement = 'Republic of Moldavo')
renamed <- str_replace(renamed, c('North Moldavo'), replacement = 'Republic of Moldavo')
renamed <- str_replace(renamed, c('Laos'), replacement = 'Lao People')
happiness2$NAME = renamed
happiness2 <- happiness
renamed <- happiness2$NAME
renamed <- str_replace(renamed, c('Libya'), replacement = 'Libyan Arab Jamahiriya')
renamed <- str_replace(renamed, c('Venezuela Bolivarian Republic of'), replacement = 'Venezuela')
renamed <- str_replace(renamed, c('South Sudan'), replacement = 'Sudan')
renamed <- str_replace(renamed, c('Congo (Brazzaville)'), replacement = 'Congo')
renamed <- str_replace(renamed, c('Congo (Kinshasa)', replacement = 'Democratic Republic of the Congo')
renamed <- str_replace(renamed, c('Tanzania'), replacement = 'United Republic of Tanzania')
renamed <- str_replace(renamed, c('Syria'), replacement = 'Syrian Arab Republic')
renamed <- str_replace(renamed, c('Iran'), replacement = 'Iran (Islamic Republic of)')
renamed <- str_replace(renamed, c('Moldova'), replacement = 'Republic of Moldavo')
renamed <- str_replace(renamed, c('North Moldavo'), replacement = 'Republic of Moldavo')
renamed <- str_replace(renamed, c('Laos'), replacement = 'Lao People')
happiness2$NAME = renamed
happiness2 <- happiness
renamed <- happiness2$NAME
renamed <- str_replace(renamed, c('Libya'), replacement = 'Libyan Arab Jamahiriya')
renamed <- str_replace(renamed, c('Venezuela Bolivarian Republic of'), replacement = 'Venezuela')
renamed <- str_replace(renamed, c('South Sudan'), replacement = 'Sudan')
renamed <- str_replace(renamed, c('Congo (Brazzaville)'), replacement = 'Congo')
renamed <- str_replace(renamed, c('Congo (Kinshasa)'), replacement = 'Democratic Republic of the Congo')
renamed <- str_replace(renamed, c('Tanzania'), replacement = 'United Republic of Tanzania')
renamed <- str_replace(renamed, c('Syria'), replacement = 'Syrian Arab Republic')
renamed <- str_replace(renamed, c('Iran'), replacement = 'Iran (Islamic Republic of)')
renamed <- str_replace(renamed, c('Moldova'), replacement = 'Republic of Moldavo')
renamed <- str_replace(renamed, c('North Moldavo'), replacement = 'Republic of Moldavo')
renamed <- str_replace(renamed, c('Laos'), replacement = 'Lao People')
happiness2$NAME = renamed
happiness2 <- happiness
renamed <- happiness2$NAME
renamed <- str_replace(renamed, c('Libya'), replacement = 'Libyan Arab Jamahiriya')
renamed <- str_replace(renamed, c('Venezuela Bolivarian Republic of'), replacement = 'Venezuela')
renamed <- str_replace(renamed, c('South Sudan'), replacement = 'Sudan')
renamed <- str_replace(renamed, c('Congo (Brazzaville)'), replacement = 'Congo')
renamed <- str_replace(renamed, c('Congo (Kinshasa)'), replacement = 'Democratic Republic of the Congo')
renamed <- str_replace(renamed, c('Tanzania'), replacement = 'United Republic of Tanzania')
renamed <- str_replace(renamed, c('Syria'), replacement = 'Syrian Arab Republic')
renamed <- str_replace(renamed, c('Iran'), replacement = 'Iran (Islamic Republic of)')
renamed <- str_replace(renamed, c('Moldova'), replacement = 'Republic of Moldavo')
renamed <- str_replace(renamed, c('North Moldavo'), replacement = 'Republic of Moldavo')
renamed <- str_replace(renamed, c('Laos'), replacement = 'Lao People Democratic Republic')
happiness2$NAME = renamed
knitr::opts_chunk$set(echo = TRUE)
happiness_venn <- happiness_2019_join %>%
mutate(happiness_category = case_when(happiness_score <= 3 ~ "very unhappy",
log10.hra > 3 & log10.hra <= 5 ~ "unhappy",
log10.hra > 5 & log10.hra <= 7 ~ "happy",
log10.hra > 7 ~ "very happy"))
library(leaflet)
library(rgdal)
library(ggplot2)
library(maps)
library(rworldmap)
library(ggmap)
library(tidyverse)
library(RColorBrewer)
library(paletteer)
library(janitor)
library(here)
library(ggthemes)
library(shiny)
library(shinydashboard)
happiness_venn <- happiness_2019_join %>%
mutate(happiness_category = case_when(happiness_score <= 3 ~ "very unhappy",
log10.hra > 3 & log10.hra <= 5 ~ "unhappy",
log10.hra > 5 & log10.hra <= 7 ~ "happy",
log10.hra > 7 ~ "very happy"))
happiness_venn <- happiness_2019_join %>%
mutate(happiness_category = case_when(happiness_score <= 3 ~ "very unhappy",
happiness_scoreappin > 3 & happiness_score <= 5 ~ "unhappy",
happiness_score > 5 & happiness_score <= 7 ~ "happy",
happiness_score > 7 ~ "very happy"))
happiness_venn <- happiness_2019_join %>%
mutate(happiness_category = case_when(happiness_score <= 3 ~ "very unhappy",
happiness_score > 3 & happiness_score <= 5 ~ "unhappy",
happiness_score > 5 & happiness_score <= 7 ~ "happy",
happiness_score > 7 ~ "very happy"))
View(happiness_venn)
happiness_venn <- happiness_2019_join %>%
mutate(economy_contribution_percentage = economy_gdp_per_capita/happiness_score)
View(happiness_venn)
happiness_venn <- happiness_2019_join %>%
mutate(economy_contribution_percentage = economy_gdp_per_capita/happiness_score,
happiness_category = case_when(happiness_score <= 3 ~ "very unhappy",
happiness_score > 3 & happiness_score <= 5 ~ "unhappy",
happiness_score > 5 & happiness_score <= 7 ~ "happy",
happiness_score > 7 ~ "very happy"))
View(happiness_venn)
View(happiness_2019_join)
View(happiness_venn)
happiness2 <- happiness
renamed <- happiness2$NAME
renamed <- str_replace(renamed, c('Libya'), replacement = 'Libyan Arab Jamahiriya')
renamed <- str_replace(renamed, c('Venezuela Bolivarian Republic of'), replacement = 'Venezuela')
renamed <- str_replace(renamed, c('South Sudan'), replacement = 'Sudan')
renamed <- str_replace(renamed, c('Congo\\(Brazzaville)\\'), replacement = 'Congo')
happiness_venn <- happiness_2019_join %>%
mutate(economy_contribution_percentage = economy_gdp_per_capita/happiness_score,
family_contribution_percentage = family/happiness_score,
health_contribution_percentage = health_life_expectancy/happiness_score,
freedom_contribution_percentage = freedom/happiness_score,
generosity_contribution_percentage = generosity/happiness_score,
happiness_category = case_when(happiness_score <= 3 ~ "very unhappy",
happiness_score > 3 & happiness_score <= 5 ~ "unhappy",
happiness_score > 5 & happiness_score <= 7 ~ "happy",
happiness_score > 7 ~ "very happy"),
economy_category = case_when(economy_contribution_percentage < 0.0833 ~ "insignificant",
economy_contribution_percentage >= 0.0833 ~ "significant"),
family_category = case_when(family_contribution_percentage < 0.0833 ~ "insignificant",
family_contribution_percentage >= 0.0833 ~ "significant"),
health_category = case_when(health_contribution_percentage < 0.0833 ~ "insignificant",
health_contribution_percentage >= 0.0833 ~ "significant"),
freedom_category = case_when(freedom_contribution_percentage < 0.0833 ~ "insignificant"),
freedom_contribution_percentage >= 0.0833 ~ "significant"),
happiness_venn <- happiness_2019_join %>%
mutate(economy_contribution_percentage = economy_gdp_per_capita/happiness_score,
family_contribution_percentage = family/happiness_score,
health_contribution_percentage = health_life_expectancy/happiness_score,
freedom_contribution_percentage = freedom/happiness_score,
generosity_contribution_percentage = generosity/happiness_score,
happiness_category = case_when(happiness_score <= 3 ~ "very unhappy",
happiness_score > 3 & happiness_score <= 5 ~ "unhappy",
happiness_score > 5 & happiness_score <= 7 ~ "happy",
happiness_score > 7 ~ "very happy"),
economy_category = case_when(economy_contribution_percentage < 0.0833 ~ "insignificant",
economy_contribution_percentage >= 0.0833 ~ "significant"),
family_category = case_when(family_contribution_percentage < 0.0833 ~ "insignificant",
family_contribution_percentage >= 0.0833 ~ "significant"),
health_category = case_when(health_contribution_percentage < 0.0833 ~ "insignificant",
health_contribution_percentage >= 0.0833 ~ "significant"),
freedom_category = case_when(freedom_contribution_percentage < 0.0833 ~ "insignificant",
freedom_contribution_percentage >= 0.0833 ~ "significant"),
generosity_category = case_when(generosity_contribution_percentage < 0.0833 ~ "insignificant",
generosity_contribution_percentage >= 0.0833 ~ "significant"))
happy_country_vec <- happiness_venn %>%
filter(happiness_category == "happy" | happiness_category == "very happy")%>%
pull(name)
happy_country_vec <- happiness_venn %>%
filter(happiness_category == "happy" | happiness_category == "very happy")%>%
pull(country_or_region)
happy_country_vec <- happiness_venn %>%
filter(happiness_category == "happy" | happiness_category == "very happy")%>%
pull(country_or_region)
gdp_vec <- happiness_venn %>%
filter(economy_category == "significant")%>%
pull(country_or_region)
generosity_vec <- happiness_venn %>%
filter(generosity_category == "significant")%>%
pull(country_or_region)
family_vec <- happiness_venn %>%
filter(family_category == "significant")%>%
pull(country_or_region)
health_vec <- happiness_venn %>%
filter(health_category == "significant")%>%
pull(country_or_region)
freedom_vec <- happiness_venn %>%
filter(freedom_category == "significant")%>%
pull(country_or_region)
happiness_venn <- happiness_2019_join %>%
mutate(economy_contribution_percentage = economy_gdp_per_capita/happiness_score,
family_contribution_percentage = family/happiness_score,
health_contribution_percentage = health_life_expectancy/happiness_score,
freedom_contribution_percentage = freedom/happiness_score,
generosity_contribution_percentage = generosity/happiness_score,
happiness_category = case_when(happiness_score <= 3 ~ "very unhappy",
happiness_score > 3 & happiness_score <= 5 ~ "unhappy",
happiness_score > 5 & happiness_score <= 7 ~ "happy",
happiness_score > 7 ~ "very happy"),
economy_category = case_when(economy_contribution_percentage < 0.1 ~ "insignificant",
economy_contribution_percentage >= 1 ~ "significant"),
family_category = case_when(family_contribution_percentage < 0.1 ~ "insignificant",
family_contribution_percentage >= 0.1 ~ "significant"),
health_category = case_when(health_contribution_percentage < 0.1 ~ "insignificant",
health_contribution_percentage >= 0.1 ~ "significant"),
freedom_category = case_when(freedom_contribution_percentage < 0.1 ~ "insignificant",
freedom_contribution_percentage >= 0.1 ~ "significant"),
generosity_category = case_when(generosity_contribution_percentage < 0.1 ~ "insignificant",
generosity_contribution_percentage >= 0.1 ~ "significant"))
happy_country_vec <- happiness_venn %>%
filter(happiness_category == "happy" | happiness_category == "very happy")%>%
pull(country_or_region)
gdp_vec <- happiness_venn %>%
filter(economy_category == "significant")%>%
pull(country_or_region)
generosity_vec <- happiness_venn %>%
filter(generosity_category == "significant")%>%
pull(country_or_region)
family_vec <- happiness_venn %>%
filter(family_category == "significant")%>%
pull(country_or_region)
health_vec <- happiness_venn %>%
filter(health_category == "significant")%>%
pull(country_or_region)
freedom_vec <- happiness_venn %>%
filter(freedom_category == "significant")%>%
pull(country_or_region)
why_happy_list <- list(happy_country_vec, gdp_vec, generosity_vec, family_vec, health_vec, freedom_vec)
ggVennDiagram(why_happy_list, category.names = c("Country with Happy Score", "GDP Contirbution", "Generosity Contribution", "Family Contirbution", "Life Expectancy Contribution", "Freedom Contribution"))
library(leaflet)
library(rgdal)
library(ggplot2)
library(maps)
library(rworldmap)
library(ggmap)
library(tidyverse)
library(RColorBrewer)
library(paletteer)
library(janitor)
library(here)
library(ggthemes)
library(shiny)
library(shinydashboard)
library(ggVennDiagram)
why_happy_list <- list(happy_country_vec, gdp_vec, generosity_vec, family_vec, health_vec, freedom_vec)
ggVennDiagram(why_happy_list, category.names = c("Country with Happy Score", "GDP Contirbution", "Generosity Contribution", "Family Contirbution", "Life Expectancy Contribution", "Freedom Contribution"))
why_happy_list <- list(happy_country_vec, gdp_vec, generosity_vec, family_vec, health_vec, freedom_vec)
ggVennDiagram(why_happy_list, category.names = c("Country with Happy Score", "GDP Contirbution", "Generosity Contribution"))
why_happy_list <- list(happy_country_vec, gdp_vec, generosity_vec)
ggVennDiagram(why_happy_list, category.names = c("Country with Happy Score", "GDP Contirbution", "Generosity Contribution"))
happiness_venn <- happiness_2019_join %>%
mutate(economy_contribution_percentage = economy_gdp_per_capita/happiness_score,
family_contribution_percentage = family/happiness_score,
health_contribution_percentage = health_life_expectancy/happiness_score,
freedom_contribution_percentage = freedom/happiness_score,
generosity_contribution_percentage = generosity/happiness_score,
happiness_category = case_when(happiness_score <= 3 ~ "very unhappy",
happiness_score > 3 & happiness_score <= 5 ~ "unhappy",
happiness_score > 5 & happiness_score <= 7 ~ "happy",
happiness_score > 7 ~ "very happy"),
economy_category = case_when(economy_contribution_percentage < 0.1 ~ "insignificant",
economy_contribution_percentage >= 1 ~ "significant"),
family_category = case_when(family_contribution_percentage < 0.1 ~ "insignificant",
family_contribution_percentage >= 0.1 ~ "significant"),
health_category = case_when(health_contribution_percentage < 0.1 ~ "insignificant",
health_contribution_percentage >= 0.1 ~ "significant"),
freedom_category = case_when(freedom_contribution_percentage < 0.1 ~ "insignificant",
freedom_contribution_percentage >= 0.1 ~ "significant"),
generosity_category = case_when(generosity_contribution_percentage < 0.1 ~ "insignificant",
generosity_contribution_percentage >= 0.1 ~ "significant"))
View(happiness_venn)
happiness_venn <- happiness_2019_join %>%
mutate(economy_contribution_percentage = economy_gdp_per_capita/happiness_score,
family_contribution_percentage = family/happiness_score,
health_contribution_percentage = health_life_expectancy/happiness_score,
freedom_contribution_percentage = freedom/happiness_score,
generosity_contribution_percentage = generosity/happiness_score,
happiness_category = case_when(happiness_score <= 3 ~ "very unhappy",
happiness_score > 3 & happiness_score <= 5 ~ "unhappy",
happiness_score > 5 & happiness_score <= 7 ~ "happy",
happiness_score > 7 ~ "very happy"),
economy_category = case_when(economy_contribution_percentage < 0.1 ~ "insignificant",
economy_contribution_percentage >= 0.1 ~ "significant"),
family_category = case_when(family_contribution_percentage < 0.1 ~ "insignificant",
family_contribution_percentage >= 0.1 ~ "significant"),
health_category = case_when(health_contribution_percentage < 0.1 ~ "insignificant",
health_contribution_percentage >= 0.1 ~ "significant"),
freedom_category = case_when(freedom_contribution_percentage < 0.1 ~ "insignificant",
freedom_contribution_percentage >= 0.1 ~ "significant"),
generosity_category = case_when(generosity_contribution_percentage < 0.1 ~ "insignificant",
generosity_contribution_percentage >= 0.1 ~ "significant"))
View(happiness_venn)
happy_country_vec <- happiness_venn %>%
filter(happiness_category == "happy" | happiness_category == "very happy")%>%
pull(country_or_region)
gdp_vec <- happiness_venn %>%
filter(economy_category == "significant")%>%
pull(country_or_region)
generosity_vec <- happiness_venn %>%
filter(generosity_category == "significant")%>%
pull(country_or_region)
family_vec <- happiness_venn %>%
filter(family_category == "significant")%>%
pull(country_or_region)
health_vec <- happiness_venn %>%
filter(health_category == "significant")%>%
pull(country_or_region)
freedom_vec <- happiness_venn %>%
filter(freedom_category == "significant")%>%
pull(country_or_region)
why_happy_list <- list(happy_country_vec, gdp_vec, generosity_vec)
ggVennDiagram(why_happy_list, category.names = c("Country with Happy Score", "GDP Contirbution", "Generosity Contribution"))
happiness_venn <- happiness_2019_join %>%
mutate(economy_contribution_percentage = economy_gdp_per_capita/happiness_score,
family_contribution_percentage = family/happiness_score,
health_contribution_percentage = health_life_expectancy/happiness_score,
freedom_contribution_percentage = freedom/happiness_score,
generosity_contribution_percentage = generosity/happiness_score,
happiness_category = case_when(happiness_score <= 3 ~ "very unhappy",
happiness_score > 3 & happiness_score <= 5 ~ "unhappy",
happiness_score > 5 & happiness_score <= 7 ~ "happy",
happiness_score > 7 ~ "very happy"),
economy_category = case_when(economy_contribution_percentage < 0.1 ~ "insignificant",
economy_contribution_percentage >= 0.1 ~ "significant"),
family_category = case_when(family_contribution_percentage < 0.1 ~ "insignificant",
family_contribution_percentage >= 0.1 ~ "significant"),
health_category = case_when(health_contribution_percentage < 0.1 ~ "insignificant",
health_contribution_percentage >= 0.1 ~ "significant"),
freedom_category = case_when(freedom_contribution_percentage < 0.1 ~ "insignificant",
freedom_contribution_percentage >= 0.1 ~ "significant"),
generosity_category = case_when(generosity_contribution_percentage < 0.1 ~ "insignificant",
generosity_contribution_percentage >= 0.1 ~ "significant"))
happy_country_vec <- happiness_venn %>%
filter(happiness_category == "happy" | happiness_category == "very happy")%>%
pull(country_or_region)
gdp_vec <- happiness_venn %>%
filter(economy_category == "significant")%>%
pull(country_or_region)
generosity_vec <- happiness_venn %>%
filter(generosity_category == "significant")%>%
pull(country_or_region)
family_vec <- happiness_venn %>%
filter(family_category == "significant")%>%
pull(country_or_region)
health_vec <- happiness_venn %>%
filter(health_category == "significant")%>%
pull(country_or_region)
freedom_vec <- happiness_venn %>%
filter(freedom_category == "significant")%>%
pull(country_or_region)
why_happy_list <- list(happy_country_vec, gdp_vec, generosity_vec)
ggVennDiagram(why_happy_list, category.names = c("Country with Happy Score", "GDP Contirbution", "Generosity Contribution"))
